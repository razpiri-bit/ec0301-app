<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo de Logística - EC0301</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
    <script src="ec0301-data-manager.js"></script>
    <style>
        :root {
            --primary: #1E3A8A; --accent: #FF6B35; --success: #22C55E;
            --light: #F8FAFC; --border: #E5E7EB; --text: #1F2937; --muted: #6B7280;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #F1F5F9; color: var(--text);
        }
        .header {
            background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky; top: 0; z-index: 1000; border-bottom: 3px solid var(--accent);
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem 1rem; }
        .header-content {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem; max-width: 1200px; margin: 0 auto;
        }
        h1 { font-size: 1.75rem; color: var(--primary); }
        .btn {
            padding: 0.6rem 1.2rem; border: none; border-radius: 8px; font-weight: 600;
            cursor: pointer; transition: all 0.3s ease; display: inline-flex;
            align-items: center; gap: 0.5rem; text-decoration: none;
        }
        .btn-secondary { background: white; color: var(--primary); border: 2px solid var(--primary); }
        .btn-primary { background: var(--primary); color: white; }
        .btn-success { background: var(--success); color: white; }

        .tabs {
            display: flex; background: var(--primary); padding: 0.5rem; border-radius: 10px;
            justify-content: center; margin-bottom: 2rem;
        }
        .tab-button {
            padding: 0.75rem 1.5rem; cursor: pointer; background: none; border: none;
            font-size: 1.1rem; font-weight: 600; color: white; opacity: 0.7;
            border-radius: 8px; transition: all 0.3s ease;
        }
        .tab-button.active { background: white; color: var(--primary); opacity: 1; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .document-container {
            background: white; padding: 3rem; border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.07); min-height: 600px;
        }
        .document-header { text-align: center; border: 2px solid var(--border); padding: 2rem; border-radius: 8px; }
        .document-header h2 { font-size: 2rem; color: var(--primary); text-transform: uppercase; }
        .document-header h3 { font-size: 1.2rem; color: var(--muted); margin-top: 0.5rem; }
        .document-info { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; text-align: left; margin-top: 2rem; }
        .document-info strong { color: var(--primary); }
        .document-footer { text-align: center; margin-top: 2rem; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 2rem; }
        th, td { border: 1px solid var(--border); padding: 1rem; text-align: left; }
        th { background: var(--light); font-weight: 600; }
        tbody tr:nth-child(even) { background: var(--light); }

        .contract-section { margin: 2rem 0; padding: 1.5rem; border-left: 4px solid var(--accent); background: var(--light); }
        .contract-section h4 { color: var(--primary); margin-bottom: 1rem; }
        .contract-section ul { margin-left: 1.5rem; }
        .contract-section li { margin-bottom: 0.5rem; }

        .requirements-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 2rem; }
        .requirement-card { background: var(--light); padding: 1.5rem; border-radius: 8px; border-left: 4px solid var(--accent); }
        .requirement-card h4 { color: var(--primary); margin-bottom: 1rem; }
        .requirement-card ul { list-style-type: disc; margin-left: 1.5rem; }
        .requirement-card li { margin-bottom: 0.5rem; }

        .signature-section { margin-top: 3rem; display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; }
        .signature-box { text-align: center; border-top: 2px solid var(--border); padding-top: 1rem; }

        /* Estilos para impresión */
        @media print {
            body * { visibility: hidden; }
            .printable, .printable * { visibility: visible; }
            .printable { position: absolute; left: 0; top: 0; width: 100%; }
            .no-print { display: none !important; }
            .document-container { padding: 1rem; box-shadow: none; }
        }
    </style>
</head>
<body>
    <header class="header no-print">
        <div class="header-content">
            <h1><i class="fa-solid fa-clipboard-list" style="color: var(--accent);"></i> Módulo de Logística</h1>
            <div>
                <a href="carta-descriptiva.html" class="btn btn-secondary"><i class="fa-solid fa-arrow-left"></i> Volver</a>
                <a href="evaluaciones.html" class="btn btn-success"><i class="fa-solid fa-arrow-right"></i> Evaluaciones</a>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="tabs no-print">
            <button class="tab-button active" onclick="showTab('asistencia')">
                <i class="fa-solid fa-users"></i> Lista de Asistencia
            </button>
            <button class="tab-button" onclick="showTab('contrato')">
                <i class="fa-solid fa-handshake"></i> Contrato de Aprendizaje
            </button>
            <button class="tab-button" onclick="showTab('requerimientos')">
                <i class="fa-solid fa-tools"></i> Lista de Requerimientos
            </button>
        </div>

        <div id="asistencia" class="tab-content active">
            <div class="document-container printable" id="asistencia-printable">
                <div class="document-header">
                    <h2>LISTA DE ASISTENCIA</h2>
                    <h3 id="asistencia-curso">Cargando información del curso...</h3>
                </div>
                <div class="document-info">
                    <div><strong>Facilitador:</strong> <span id="asistencia-facilitador">-</span></div>
                    <div><strong>Lugar:</strong> <span id="asistencia-lugar">-</span></div>
                    <div><strong>Duración:</strong> <span id="asistencia-duracion">-</span> horas</div>
                    <div><strong>Fechas:</strong> <span id="asistencia-fechas">-</span></div>
                </div>
                <table id="asistencia-table">
                    <thead>
                        <tr>
                            <th style="width: 8%;">No.</th>
                            <th style="width: 50%;">Nombre Completo del Participante</th>
                            <th style="width: 21%;">Firma Día 1</th>
                            <th style="width: 21%;">Firma Día 2</th>
                        </tr>
                    </thead>
                    <tbody id="asistencia-tbody">
                    </tbody>
                </table>
                <div class="signature-section">
                    <div class="signature-box">
                        <strong>Facilitador</strong><br>
                        <span id="firma-facilitador">Nombre del Facilitador</span>
                    </div>
                    <div class="signature-box">
                        <strong>Coordinador Académico</strong><br>
                        Nombre y Firma
                    </div>
                </div>
            </div>
            <div class="document-footer no-print">
                <button class="btn btn-primary" onclick="printDocument('asistencia-printable')">
                    <i class="fa-solid fa-print"></i> Imprimir Lista
                </button>
                <button class="btn btn-success" onclick="generatePDF('asistencia')">
                    <i class="fa-solid fa-file-pdf"></i> Generar PDF
                </button>
            </div>
        </div>

        <div id="contrato" class="tab-content">
            <div class="document-container printable" id="contrato-printable">
                <div class="document-header">
                    <h2>CONTRATO DE APRENDIZAJE</h2>
                    <h3 id="contrato-curso">Curso de Capacitación</h3>
                </div>
                <div class="document-info">
                    <div><strong>Facilitador:</strong> <span id="contrato-facilitador">-</span></div>
                    <div><strong>Lugar:</strong> <span id="contrato-lugar">-</span></div>
                    <div><strong>Duración:</strong> <span id="contrato-duracion">-</span> horas</div>
                    <div><strong>Fechas:</strong> <span id="contrato-fechas">-</span></div>
                </div>

                <div class="contract-section">
                    <h4>COMPROMISOS DEL FACILITADOR</h4>
                    <ul>
                        <li>Impartir el curso conforme a la carta descriptiva y objetivos establecidos</li>
                        <li>Proporcionar los materiales didácticos necesarios para el aprendizaje</li>
                        <li>Mantener un ambiente de respeto y profesionalismo durante las sesiones</li>
                        <li>Evaluar de manera objetiva y constructiva el desempeño de los participantes</li>
                        <li>Resolver dudas y proporcionar retroalimentación oportuna</li>
                        <li>Cumplir con los horarios establecidos y aprovechar al máximo el tiempo de clase</li>
                    </ul>
                </div>

                <div class="contract-section">
                    <h4>COMPROMISOS DE LOS PARTICIPANTES</h4>
                    <ul>
                        <li>Asistir puntualmente a todas las sesiones programadas (mínimo 90% de asistencia)</li>
                        <li>Participar activamente en las actividades y ejercicios propuestos</li>
                        <li>Mantener una actitud de respeto hacia el facilitador y compañeros</li>
                        <li>Cumplir con las tareas y actividades asignadas en tiempo y forma</li>
                        <li>Presentar las evaluaciones programadas según el calendario establecido</li>
                        <li>Cuidar y hacer buen uso de los materiales y equipos proporcionados</li>
                        <li>Mantener la confidencialidad de la información compartida en clase</li>
                    </ul>
                </div>

                <div class="contract-section">
                    <h4>CRITERIOS DE EVALUACIÓN</h4>
                    <ul>
                        <li><strong>Evaluación Formativa:</strong> <span id="contrato-eval-form">40%</span> - Participación y actividades prácticas</li>
                        <li><strong>Evaluación Sumativa:</strong> <span id="contrato-eval-sum">60%</span> - Examen final y proyecto integrador</li>
                        <li><strong>Calificación Mínima Aprobatoria:</strong> <span id="contrato-eval-min">80</span> puntos</li>
                        <li><strong>Asistencia Mínima Requerida:</strong> 90% de las sesiones programadas</li>
                    </ul>
                </div>

                <div class="contract-section">
                    <h4>PERFIL DE EGRESO</h4>
                    <p id="contrato-perfil">Al término del curso, el participante habrá desarrollado las competencias necesarias para...</p>
                </div>

                <div class="signature-section">
                    <div class="signature-box">
                        <strong>Facilitador</strong><br>
                        <span id="contrato-firma-facilitador">Nombre del Facilitador</span><br>
                        Fecha: ________________
                    </div>
                    <div class="signature-box">
                        <strong>Participante</strong><br>
                        Nombre: ________________________________<br>
                        Firma: _____________________ Fecha: _______
                    </div>
                </div>
            </div>
            <div class="document-footer no-print">
                <button class="btn btn-primary" onclick="printDocument('contrato-printable')">
                    <i class="fa-solid fa-print"></i> Imprimir Contrato
                </button>
                <button class="btn btn-success" onclick="generatePDF('contrato')">
                    <i class="fa-solid fa-file-pdf"></i> Generar PDF
                </button>
            </div>
        </div>

        <div id="requerimientos" class="tab-content">
            <div class="document-container printable" id="requerimientos-printable">
                <div class="document-header">
                    <h2>LISTA DE REQUERIMIENTOS</h2>
                    <h3 id="req-curso">Especificaciones Técnicas y Logísticas</h3>
                </div>
                <div class="document-info">
                    <div><strong>Facilitador:</strong> <span id="req-facilitador">-</span></div>
                    <div><strong>Lugar:</strong> <span id="req-lugar">-</span></div>
                    <div><strong>Participantes:</strong> <span id="req-participantes">-</span> personas</div>
                    <div><strong>Duración:</strong> <span id="req-duracion">-</span> horas</div>
                </div>

                <div class="requirements-grid">
                    <div class="requirement-card">
                        <h4><i class="fa-solid fa-building"></i> INSTALACIONES</h4>
                        <div id="req-instalaciones-content">
                            <p>Cargando requerimientos de instalaciones...</p>
                        </div>
                    </div>

                    <div class="requirement-card">
                        <h4><i class="fa-solid fa-laptop"></i> EQUIPO Y MOBILIARIO</h4>
                        <div id="req-equipo-content">
                            <p>Cargando requerimientos de equipo...</p>
                        </div>
                    </div>

                    <div class="requirement-card">
                        <h4><i class="fa-solid fa-box"></i> MATERIALES</h4>
                        <div id="req-materiales-content">
                            <p>Cargando requerimientos de materiales...</p>
                        </div>
                    </div>
                </div>

                <div class="contract-section">
                    <h4>ESPECIFICACIONES ADICIONALES</h4>
                    <ul>
                        <li><strong>Conectividad:</strong> Internet banda ancha para actividades en línea</li>
                        <li><strong>Alimentación:</strong> Coffee break a media mañana y tarde</li>
                        <li><strong>Estacionamiento:</strong> Disponible para todos los participantes</li>
                        <li><strong>Accesibilidad:</strong> Instalaciones accesibles para personas con discapacidad</li>
                        <li><strong>Climatización:</strong> Temperatura controlada entre 20-24°C</li>
                        <li><strong>Seguridad:</strong> Salidas de emergencia señalizadas y extintores</li>
                    </ul>
                </div>

                <div class="signature-section">
                    <div class="signature-box">
                        <strong>Coordinador Académico</strong><br>
                        Nombre y Firma<br>
                        Fecha: ________________
                    </div>
                    <div class="signature-box">
                        <strong>Responsable de Logística</strong><br>
                        Nombre y Firma<br>
                        Fecha: ________________
                    </div>
                </div>
            </div>
            <div class="document-footer no-print">
                <button class="btn btn-primary" onclick="printDocument('requerimientos-printable')">
                    <i class="fa-solid fa-print"></i> Imprimir Lista
                </button>
                <button class="btn btn-success" onclick="generatePDF('requerimientos')">
                    <i class="fa-solid fa-file-pdf"></i> Generar PDF
                </button>
            </div>
        </div>
    </main>

    <script>
        // Cargar datos automáticamente al inicializar
        document.addEventListener('DOMContentLoaded', () => {
            loadLogisticaData();
        });

        function loadLogisticaData() {
            try {
                const moduleData = EC0301Manager.getModuleData('logistica');
                
                // Datos para lista de asistencia
                document.getElementById('asistencia-curso').textContent = moduleData.curso || 'Nombre del Curso';
                document.getElementById('asistencia-facilitador').textContent = moduleData.facilitador || 'Nombre del Facilitador';
                document.getElementById('asistencia-lugar').textContent = moduleData.lugar || 'Lugar de Impartición';
                document.getElementById('asistencia-duracion').textContent = moduleData.duracion || '0';
                document.getElementById('asistencia-fechas').textContent = moduleData.fechas || 'Fechas por definir';
                document.getElementById('firma-facilitador').textContent = moduleData.facilitador || 'Nombre del Facilitador';

                // Datos para contrato
                document.getElementById('contrato-curso').textContent = moduleData.curso || 'Nombre del Curso';
                document.getElementById('contrato-facilitador').textContent = moduleData.facilitador || 'Nombre del Facilitador';
                document.getElementById('contrato-lugar').textContent = moduleData.lugar || 'Lugar de Impartición';
                document.getElementById('contrato-duracion').textContent = moduleData.duracion || '0';
                document.getElementById('contrato-fechas').textContent = moduleData.fechas || 'Fechas por definir';
                document.getElementById('contrato-firma-facilitador').textContent = moduleData.facilitador || 'Nombre del Facilitador';

                // Datos de evaluación para contrato
                const cartaData = EC0301Manager.getData();
                if (cartaData.ev) {
                    document.getElementById('contrato-eval-form').textContent = (cartaData.ev.form?.pct || '40') + '%';
                    document.getElementById('contrato-eval-sum').textContent = (cartaData.ev.sum?.pct || '60%');
                    document.getElementById('contrato-eval-min').textContent = cartaData.ev.min || '80';
                }

                // Perfil para contrato (objetivo general)
                if (cartaData.og) {
                    const objetivoCompleto = `${cartaData.og.accion || ''} ${cartaData.og.cond || ''} ${cartaData.og.criterio || ''}`.trim();
                    document.getElementById('contrato-perfil').textContent = objetivoCompleto || 'Perfil de egreso por definir';
                }

                // Datos para requerimientos
                document.getElementById('req-curso').textContent = moduleData.curso || 'Nombre del Curso';
                document.getElementById('req-facilitador').textContent = moduleData.facilitador || 'Nombre del Facilitador';
                document.getElementById('req-lugar').textContent = moduleData.lugar || 'Lugar de Impartición';
                document.getElementById('req-participantes').textContent = moduleData.participantes || '0';
                document.getElementById('req-duracion').textContent = moduleData.duracion || '0';

                // Generar tabla de asistencia
                generateAsistenciaTable(parseInt(moduleData.participantes) || 15);

                // Cargar requerimientos específicos
                loadRequerimientos(moduleData);

            } catch (error) {
                console.error('Error cargando datos de logística:', error);
                showMissingDataAlert();
            }
        }

        function generateAsistenciaTable(numParticipantes) {
            const tbody = document.getElementById('asistencia-tbody');
            tbody.innerHTML = '';

            for (let i = 1; i <= numParticipantes; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="text-align: center; font-weight: 600;">${i}</td>
                    <td style="height: 40px; border-bottom: 1px solid #ccc;"></td>
                    <td style="border-bottom: 1px solid #ccc;"></td>
                    <td style="border-bottom: 1px solid #ccc;"></td>
                `;
                tbody.appendChild(row);
            }
        }

        function loadRequerimientos(moduleData) {
            // Instalaciones
            const instalacionesDiv = document.getElementById('req-instalaciones-content');
            if (moduleData.instalaciones) {
                const instalacionesList = moduleData.instalaciones.split(/[.,;]/).filter(item => item.trim());
                instalacionesDiv.innerHTML = `
                    <ul>
                        ${instalacionesList.map(item => `<li>${item.trim()}</li>`).join('')}
                    </ul>
                `;
            } else {
                instalacionesDiv.innerHTML = '<p style="color: var(--muted);">No especificado en carta descriptiva</p>';
            }

            // Equipo
            const equipoDiv = document.getElementById('req-equipo-content');
            if (moduleData.equipo) {
                const equipoList = moduleData.equipo.split(/[.,;]/).filter(item => item.trim());
                equipoDiv.innerHTML = `
                    <ul>
                        ${equipoList.map(item => `<li>${item.trim()}</li>`).join('')}
                    </ul>
                `;
            } else {
                equipoDiv.innerHTML = '<p style="color: var(--muted);">No especificado en carta descriptiva</p>';
            }

            // Materiales
            const materialesDiv = document.getElementById('req-materiales-content');
            if (moduleData.materiales) {
                const materialesList = moduleData.materiales.split(/[.,;]/).filter(item => item.trim());
                materialesDiv.innerHTML = `
                    <ul>
                        ${materialesList.map(item => `<li>${item.trim()}</li>`).join('')}
                    </ul>
                `;
            } else {
                materialesDiv.innerHTML = '<p style="color: var(--muted);">No especificado en carta descriptiva</p>';
            }
        }

        function showMissingDataAlert() {
            Swal.fire({
                icon: 'warning',
                title: 'Datos Incompletos',
                html: 'No se encontraron datos de la carta descriptiva.<br>Por favor, completa primero la <strong>Carta Descriptiva</strong>.',
                confirmButtonText: 'Ir a Carta Descriptiva',
                confirmButtonColor: '#1E3A8A'
            }).then(() => {
                window.location.href = 'carta-descriptiva.html';
            });
        }

        function showTab(tabName) {
            // Ocultar todos los contenidos de tab
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remover clase active de todos los botones
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });

            // Mostrar el contenido seleccionado
            document.getElementById(tabName).classList.add('active');
            
            // Activar el botón correspondiente
            event.target.classList.add('active');
        }

        function printDocument(elementId) {
            const printContent = document.getElementById(elementId);
            const originalContent = document.body.innerHTML;

            // Obtener estilos
            const styles = Array.from(document.styleSheets).map(styleSheet => {
                try {
                    return Array.from(styleSheet.cssRules).map(rule => rule.cssText).join('');
                } catch (e) {
                    return '';
                }
            }).filter(Boolean).join('\n');

            // Crear ventana de impresión
            const printWindow = window.open('', '', 'height=800,width=1200');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Imprimir Documento</title>
                    <style>
                        ${styles}
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .document-container { padding: 20px; }
                        @media print { 
                            body { margin: 0; }
                            .document-container { padding: 10px; }
                        }
                    </style>
                </head>
                <body>
                    <div class="document-container">
                        ${printContent.innerHTML}
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 500);
        }

        function generatePDF(documentType) {
            Swal.fire({
                title: 'Generando PDF...',
                text: 'Creando documento en formato PDF',
                allowOutsideClick: false,
                didOpen: () => Swal.showLoading()
            });

            setTimeout(() => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                const moduleData = EC0301Manager.getModuleData('logistica');

                switch(documentType) {
                    case 'asistencia':
                        generateAsistenciaPDF(doc, moduleData);
                        break;
                    case 'contrato':
                        generateContratoPDF(doc, moduleData);
                        break;
                    case 'requerimientos':
                        generateRequerimientosPDF(doc, moduleData);
                        break;
                }

                Swal.fire({
                    icon: 'success',
                    title: 'PDF Generado',
                    text: 'El documento se ha descargado correctamente',
                    timer: 2000,
                    timerProgressBar: true
                });
            }, 1500);
        }

        function generateAsistenciaPDF(doc, moduleData) {
            // Título
            doc.setFontSize(18);
            doc.setTextColor(30, 58, 138);
            doc.text('LISTA DE ASISTENCIA', 105, 20, { align: 'center' });

            // Información del curso
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text(`Curso: ${moduleData.curso || ''}`, 20, 40);
            doc.text(`Facilitador: ${moduleData.facilitador || ''}`, 20, 50);
            doc.text(`Lugar: ${moduleData.lugar || ''}`, 20, 60);
            doc.text(`Duración: ${moduleData.duracion || ''} horas`, 120, 50);
            doc.text(`Fechas: ${moduleData.fechas || ''}`, 120, 60);

            // Tabla de asistencia
            const participantes = parseInt(moduleData.participantes) || 15;
            const tableData = [];
            for (let i = 1; i <= participantes; i++) {
                tableData.push([i.toString(), '', '', '']);
            }

            doc.autoTable({
                startY: 75,
                head: [['No.', 'Nombre Completo del Participante', 'Firma Día 1', 'Firma Día 2']],
                body: tableData,
                theme: 'grid',
                headStyles: { fillColor: [30, 58, 138] },
                columnStyles: {
                    0: { cellWidth: 15 },
                    1: { cellWidth: 80 },
                    2: { cellWidth: 40 },
                    3: { cellWidth: 40 }
                }
            });

            doc.save(`Lista_Asistencia_${moduleData.curso || 'Curso'}.pdf`);
        }

        function generateContratoPDF(doc, moduleData) {
            // Implementar generación de PDF para contrato
            doc.setFontSize(18);
            doc.text('CONTRATO DE APRENDIZAJE', 105, 20, { align: 'center' });
            // ... resto de la implementación
            doc.save(`Contrato_Aprendizaje_${moduleData.curso || 'Curso'}.pdf`);
        }

        function generateRequerimientosPDF(doc, moduleData) {
            // Implementar generación de PDF para requerimientos
            doc.setFontSize(18);
            doc.text('LISTA DE REQUERIMIENTOS', 105, 20, { align: 'center' });
            // ... resto de la implementación
            doc.save(`Lista_Requerimientos_${moduleData.curso || 'Curso'}.pdf`);
        }

        // Suscribirse a cambios en la carta descriptiva
        EC0301Manager.onDataChange('logistica', (changedFields, fullData) => {
            console.log('Datos actualizados desde carta descriptiva:', changedFields);
            loadLogisticaData();
        });
    </script>
</body>
</html>
